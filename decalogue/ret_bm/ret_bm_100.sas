libname r "!userprofile\desktop\sas\decalogue\ret_bm\";

rsubmit;

proc sql;
	create table ret_bm_100 as
		select date,
			sum(ifn(bm=-1,size1,.)*ret)/sum(ifn(bm=-1,size1,.)) as bn,
			sum(ifn(bm=0,size1,.)*ret)/sum(ifn(bm=0,size1,.)) as b00,
			sum(ifn(bm=1,size1,.)*ret)/sum(ifn(bm=1,size1,.)) as b01,
			sum(ifn(bm=2,size1,.)*ret)/sum(ifn(bm=2,size1,.)) as b02,
			sum(ifn(bm=3,size1,.)*ret)/sum(ifn(bm=3,size1,.)) as b03,
			sum(ifn(bm=4,size1,.)*ret)/sum(ifn(bm=4,size1,.)) as b04,
			sum(ifn(bm=5,size1,.)*ret)/sum(ifn(bm=5,size1,.)) as b05,
			sum(ifn(bm=6,size1,.)*ret)/sum(ifn(bm=6,size1,.)) as b06,
			sum(ifn(bm=7,size1,.)*ret)/sum(ifn(bm=7,size1,.)) as b07,
			sum(ifn(bm=8,size1,.)*ret)/sum(ifn(bm=8,size1,.)) as b08,
			sum(ifn(bm=9,size1,.)*ret)/sum(ifn(bm=9,size1,.)) as b09,
			sum(ifn(bm=10,size1,.)*ret)/sum(ifn(bm=10,size1,.)) as b10,
			sum(ifn(bm=11,size1,.)*ret)/sum(ifn(bm=11,size1,.)) as b11,
			sum(ifn(bm=12,size1,.)*ret)/sum(ifn(bm=12,size1,.)) as b12,
			sum(ifn(bm=13,size1,.)*ret)/sum(ifn(bm=13,size1,.)) as b13,
			sum(ifn(bm=14,size1,.)*ret)/sum(ifn(bm=14,size1,.)) as b14,
			sum(ifn(bm=15,size1,.)*ret)/sum(ifn(bm=15,size1,.)) as b15,
			sum(ifn(bm=16,size1,.)*ret)/sum(ifn(bm=16,size1,.)) as b16,
			sum(ifn(bm=17,size1,.)*ret)/sum(ifn(bm=17,size1,.)) as b17,
			sum(ifn(bm=18,size1,.)*ret)/sum(ifn(bm=18,size1,.)) as b18,
			sum(ifn(bm=19,size1,.)*ret)/sum(ifn(bm=19,size1,.)) as b19,
			sum(ifn(bm=20,size1,.)*ret)/sum(ifn(bm=20,size1,.)) as b20,
			sum(ifn(bm=21,size1,.)*ret)/sum(ifn(bm=21,size1,.)) as b21,
			sum(ifn(bm=22,size1,.)*ret)/sum(ifn(bm=22,size1,.)) as b22,
			sum(ifn(bm=23,size1,.)*ret)/sum(ifn(bm=23,size1,.)) as b23,
			sum(ifn(bm=24,size1,.)*ret)/sum(ifn(bm=24,size1,.)) as b24,
			sum(ifn(bm=25,size1,.)*ret)/sum(ifn(bm=25,size1,.)) as b25,
			sum(ifn(bm=26,size1,.)*ret)/sum(ifn(bm=26,size1,.)) as b26,
			sum(ifn(bm=27,size1,.)*ret)/sum(ifn(bm=27,size1,.)) as b27,
			sum(ifn(bm=28,size1,.)*ret)/sum(ifn(bm=28,size1,.)) as b28,
			sum(ifn(bm=29,size1,.)*ret)/sum(ifn(bm=29,size1,.)) as b29,
			sum(ifn(bm=30,size1,.)*ret)/sum(ifn(bm=30,size1,.)) as b30,
			sum(ifn(bm=31,size1,.)*ret)/sum(ifn(bm=31,size1,.)) as b31,
			sum(ifn(bm=32,size1,.)*ret)/sum(ifn(bm=32,size1,.)) as b32,
			sum(ifn(bm=33,size1,.)*ret)/sum(ifn(bm=33,size1,.)) as b33,
			sum(ifn(bm=34,size1,.)*ret)/sum(ifn(bm=34,size1,.)) as b34,
			sum(ifn(bm=35,size1,.)*ret)/sum(ifn(bm=35,size1,.)) as b35,
			sum(ifn(bm=36,size1,.)*ret)/sum(ifn(bm=36,size1,.)) as b36,
			sum(ifn(bm=37,size1,.)*ret)/sum(ifn(bm=37,size1,.)) as b37,
			sum(ifn(bm=38,size1,.)*ret)/sum(ifn(bm=38,size1,.)) as b38,
			sum(ifn(bm=39,size1,.)*ret)/sum(ifn(bm=39,size1,.)) as b39,
			sum(ifn(bm=40,size1,.)*ret)/sum(ifn(bm=40,size1,.)) as b40,
			sum(ifn(bm=41,size1,.)*ret)/sum(ifn(bm=41,size1,.)) as b41,
			sum(ifn(bm=42,size1,.)*ret)/sum(ifn(bm=42,size1,.)) as b42,
			sum(ifn(bm=43,size1,.)*ret)/sum(ifn(bm=43,size1,.)) as b43,
			sum(ifn(bm=44,size1,.)*ret)/sum(ifn(bm=44,size1,.)) as b44,
			sum(ifn(bm=45,size1,.)*ret)/sum(ifn(bm=45,size1,.)) as b45,
			sum(ifn(bm=46,size1,.)*ret)/sum(ifn(bm=46,size1,.)) as b46,
			sum(ifn(bm=47,size1,.)*ret)/sum(ifn(bm=47,size1,.)) as b47,
			sum(ifn(bm=48,size1,.)*ret)/sum(ifn(bm=48,size1,.)) as b48,
			sum(ifn(bm=49,size1,.)*ret)/sum(ifn(bm=49,size1,.)) as b49,
			sum(ifn(bm=50,size1,.)*ret)/sum(ifn(bm=50,size1,.)) as b50,
			sum(ifn(bm=51,size1,.)*ret)/sum(ifn(bm=51,size1,.)) as b51,
			sum(ifn(bm=52,size1,.)*ret)/sum(ifn(bm=52,size1,.)) as b52,
			sum(ifn(bm=53,size1,.)*ret)/sum(ifn(bm=53,size1,.)) as b53,
			sum(ifn(bm=54,size1,.)*ret)/sum(ifn(bm=54,size1,.)) as b54,
			sum(ifn(bm=55,size1,.)*ret)/sum(ifn(bm=55,size1,.)) as b55,
			sum(ifn(bm=56,size1,.)*ret)/sum(ifn(bm=56,size1,.)) as b56,
			sum(ifn(bm=57,size1,.)*ret)/sum(ifn(bm=57,size1,.)) as b57,
			sum(ifn(bm=58,size1,.)*ret)/sum(ifn(bm=58,size1,.)) as b58,
			sum(ifn(bm=59,size1,.)*ret)/sum(ifn(bm=59,size1,.)) as b59,
			sum(ifn(bm=60,size1,.)*ret)/sum(ifn(bm=60,size1,.)) as b60,
			sum(ifn(bm=61,size1,.)*ret)/sum(ifn(bm=61,size1,.)) as b61,
			sum(ifn(bm=62,size1,.)*ret)/sum(ifn(bm=62,size1,.)) as b62,
			sum(ifn(bm=63,size1,.)*ret)/sum(ifn(bm=63,size1,.)) as b63,
			sum(ifn(bm=64,size1,.)*ret)/sum(ifn(bm=64,size1,.)) as b64,
			sum(ifn(bm=65,size1,.)*ret)/sum(ifn(bm=65,size1,.)) as b65,
			sum(ifn(bm=66,size1,.)*ret)/sum(ifn(bm=66,size1,.)) as b66,
			sum(ifn(bm=67,size1,.)*ret)/sum(ifn(bm=67,size1,.)) as b67,
			sum(ifn(bm=68,size1,.)*ret)/sum(ifn(bm=68,size1,.)) as b68,
			sum(ifn(bm=69,size1,.)*ret)/sum(ifn(bm=69,size1,.)) as b69,
			sum(ifn(bm=70,size1,.)*ret)/sum(ifn(bm=70,size1,.)) as b70,
			sum(ifn(bm=71,size1,.)*ret)/sum(ifn(bm=71,size1,.)) as b71,
			sum(ifn(bm=72,size1,.)*ret)/sum(ifn(bm=72,size1,.)) as b72,
			sum(ifn(bm=73,size1,.)*ret)/sum(ifn(bm=73,size1,.)) as b73,
			sum(ifn(bm=74,size1,.)*ret)/sum(ifn(bm=74,size1,.)) as b74,
			sum(ifn(bm=75,size1,.)*ret)/sum(ifn(bm=75,size1,.)) as b75,
			sum(ifn(bm=76,size1,.)*ret)/sum(ifn(bm=76,size1,.)) as b76,
			sum(ifn(bm=77,size1,.)*ret)/sum(ifn(bm=77,size1,.)) as b77,
			sum(ifn(bm=78,size1,.)*ret)/sum(ifn(bm=78,size1,.)) as b78,
			sum(ifn(bm=79,size1,.)*ret)/sum(ifn(bm=79,size1,.)) as b79,
			sum(ifn(bm=80,size1,.)*ret)/sum(ifn(bm=80,size1,.)) as b80,
			sum(ifn(bm=81,size1,.)*ret)/sum(ifn(bm=81,size1,.)) as b81,
			sum(ifn(bm=82,size1,.)*ret)/sum(ifn(bm=82,size1,.)) as b82,
			sum(ifn(bm=83,size1,.)*ret)/sum(ifn(bm=83,size1,.)) as b83,
			sum(ifn(bm=84,size1,.)*ret)/sum(ifn(bm=84,size1,.)) as b84,
			sum(ifn(bm=85,size1,.)*ret)/sum(ifn(bm=85,size1,.)) as b85,
			sum(ifn(bm=86,size1,.)*ret)/sum(ifn(bm=86,size1,.)) as b86,
			sum(ifn(bm=87,size1,.)*ret)/sum(ifn(bm=87,size1,.)) as b87,
			sum(ifn(bm=88,size1,.)*ret)/sum(ifn(bm=88,size1,.)) as b88,
			sum(ifn(bm=89,size1,.)*ret)/sum(ifn(bm=89,size1,.)) as b89,
			sum(ifn(bm=90,size1,.)*ret)/sum(ifn(bm=90,size1,.)) as b90,
			sum(ifn(bm=91,size1,.)*ret)/sum(ifn(bm=91,size1,.)) as b91,
			sum(ifn(bm=92,size1,.)*ret)/sum(ifn(bm=92,size1,.)) as b92,
			sum(ifn(bm=93,size1,.)*ret)/sum(ifn(bm=93,size1,.)) as b93,
			sum(ifn(bm=94,size1,.)*ret)/sum(ifn(bm=94,size1,.)) as b94,
			sum(ifn(bm=95,size1,.)*ret)/sum(ifn(bm=95,size1,.)) as b95,
			sum(ifn(bm=96,size1,.)*ret)/sum(ifn(bm=96,size1,.)) as b96,
			sum(ifn(bm=97,size1,.)*ret)/sum(ifn(bm=97,size1,.)) as b97,
			sum(ifn(bm=98,size1,.)*ret)/sum(ifn(bm=98,size1,.)) as b98,
			sum(ifn(bm=99,size1,.)*ret)/sum(ifn(bm=99,size1,.)) as b99
		from ret_bm
		group by date
		order by date;
quit;

proc download out=r.ret_bm_100;
run;

endrsubmit;
