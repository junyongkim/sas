libname r "!userprofile\desktop\sas\decalogue\ret_ret5\";

rsubmit;

proc sql;
	create table retd_ret5_100 as
		select date,
			sum(ifn(ret5=0,size1,.)*retd)/sum(ifn(ret5=0,size1,.)) as r00,
			sum(ifn(ret5=1,size1,.)*retd)/sum(ifn(ret5=1,size1,.)) as r01,
			sum(ifn(ret5=2,size1,.)*retd)/sum(ifn(ret5=2,size1,.)) as r02,
			sum(ifn(ret5=3,size1,.)*retd)/sum(ifn(ret5=3,size1,.)) as r03,
			sum(ifn(ret5=4,size1,.)*retd)/sum(ifn(ret5=4,size1,.)) as r04,
			sum(ifn(ret5=5,size1,.)*retd)/sum(ifn(ret5=5,size1,.)) as r05,
			sum(ifn(ret5=6,size1,.)*retd)/sum(ifn(ret5=6,size1,.)) as r06,
			sum(ifn(ret5=7,size1,.)*retd)/sum(ifn(ret5=7,size1,.)) as r07,
			sum(ifn(ret5=8,size1,.)*retd)/sum(ifn(ret5=8,size1,.)) as r08,
			sum(ifn(ret5=9,size1,.)*retd)/sum(ifn(ret5=9,size1,.)) as r09,
			sum(ifn(ret5=10,size1,.)*retd)/sum(ifn(ret5=10,size1,.)) as r10,
			sum(ifn(ret5=11,size1,.)*retd)/sum(ifn(ret5=11,size1,.)) as r11,
			sum(ifn(ret5=12,size1,.)*retd)/sum(ifn(ret5=12,size1,.)) as r12,
			sum(ifn(ret5=13,size1,.)*retd)/sum(ifn(ret5=13,size1,.)) as r13,
			sum(ifn(ret5=14,size1,.)*retd)/sum(ifn(ret5=14,size1,.)) as r14,
			sum(ifn(ret5=15,size1,.)*retd)/sum(ifn(ret5=15,size1,.)) as r15,
			sum(ifn(ret5=16,size1,.)*retd)/sum(ifn(ret5=16,size1,.)) as r16,
			sum(ifn(ret5=17,size1,.)*retd)/sum(ifn(ret5=17,size1,.)) as r17,
			sum(ifn(ret5=18,size1,.)*retd)/sum(ifn(ret5=18,size1,.)) as r18,
			sum(ifn(ret5=19,size1,.)*retd)/sum(ifn(ret5=19,size1,.)) as r19,
			sum(ifn(ret5=20,size1,.)*retd)/sum(ifn(ret5=20,size1,.)) as r20,
			sum(ifn(ret5=21,size1,.)*retd)/sum(ifn(ret5=21,size1,.)) as r21,
			sum(ifn(ret5=22,size1,.)*retd)/sum(ifn(ret5=22,size1,.)) as r22,
			sum(ifn(ret5=23,size1,.)*retd)/sum(ifn(ret5=23,size1,.)) as r23,
			sum(ifn(ret5=24,size1,.)*retd)/sum(ifn(ret5=24,size1,.)) as r24,
			sum(ifn(ret5=25,size1,.)*retd)/sum(ifn(ret5=25,size1,.)) as r25,
			sum(ifn(ret5=26,size1,.)*retd)/sum(ifn(ret5=26,size1,.)) as r26,
			sum(ifn(ret5=27,size1,.)*retd)/sum(ifn(ret5=27,size1,.)) as r27,
			sum(ifn(ret5=28,size1,.)*retd)/sum(ifn(ret5=28,size1,.)) as r28,
			sum(ifn(ret5=29,size1,.)*retd)/sum(ifn(ret5=29,size1,.)) as r29,
			sum(ifn(ret5=30,size1,.)*retd)/sum(ifn(ret5=30,size1,.)) as r30,
			sum(ifn(ret5=31,size1,.)*retd)/sum(ifn(ret5=31,size1,.)) as r31,
			sum(ifn(ret5=32,size1,.)*retd)/sum(ifn(ret5=32,size1,.)) as r32,
			sum(ifn(ret5=33,size1,.)*retd)/sum(ifn(ret5=33,size1,.)) as r33,
			sum(ifn(ret5=34,size1,.)*retd)/sum(ifn(ret5=34,size1,.)) as r34,
			sum(ifn(ret5=35,size1,.)*retd)/sum(ifn(ret5=35,size1,.)) as r35,
			sum(ifn(ret5=36,size1,.)*retd)/sum(ifn(ret5=36,size1,.)) as r36,
			sum(ifn(ret5=37,size1,.)*retd)/sum(ifn(ret5=37,size1,.)) as r37,
			sum(ifn(ret5=38,size1,.)*retd)/sum(ifn(ret5=38,size1,.)) as r38,
			sum(ifn(ret5=39,size1,.)*retd)/sum(ifn(ret5=39,size1,.)) as r39,
			sum(ifn(ret5=40,size1,.)*retd)/sum(ifn(ret5=40,size1,.)) as r40,
			sum(ifn(ret5=41,size1,.)*retd)/sum(ifn(ret5=41,size1,.)) as r41,
			sum(ifn(ret5=42,size1,.)*retd)/sum(ifn(ret5=42,size1,.)) as r42,
			sum(ifn(ret5=43,size1,.)*retd)/sum(ifn(ret5=43,size1,.)) as r43,
			sum(ifn(ret5=44,size1,.)*retd)/sum(ifn(ret5=44,size1,.)) as r44,
			sum(ifn(ret5=45,size1,.)*retd)/sum(ifn(ret5=45,size1,.)) as r45,
			sum(ifn(ret5=46,size1,.)*retd)/sum(ifn(ret5=46,size1,.)) as r46,
			sum(ifn(ret5=47,size1,.)*retd)/sum(ifn(ret5=47,size1,.)) as r47,
			sum(ifn(ret5=48,size1,.)*retd)/sum(ifn(ret5=48,size1,.)) as r48,
			sum(ifn(ret5=49,size1,.)*retd)/sum(ifn(ret5=49,size1,.)) as r49,
			sum(ifn(ret5=50,size1,.)*retd)/sum(ifn(ret5=50,size1,.)) as r50,
			sum(ifn(ret5=51,size1,.)*retd)/sum(ifn(ret5=51,size1,.)) as r51,
			sum(ifn(ret5=52,size1,.)*retd)/sum(ifn(ret5=52,size1,.)) as r52,
			sum(ifn(ret5=53,size1,.)*retd)/sum(ifn(ret5=53,size1,.)) as r53,
			sum(ifn(ret5=54,size1,.)*retd)/sum(ifn(ret5=54,size1,.)) as r54,
			sum(ifn(ret5=55,size1,.)*retd)/sum(ifn(ret5=55,size1,.)) as r55,
			sum(ifn(ret5=56,size1,.)*retd)/sum(ifn(ret5=56,size1,.)) as r56,
			sum(ifn(ret5=57,size1,.)*retd)/sum(ifn(ret5=57,size1,.)) as r57,
			sum(ifn(ret5=58,size1,.)*retd)/sum(ifn(ret5=58,size1,.)) as r58,
			sum(ifn(ret5=59,size1,.)*retd)/sum(ifn(ret5=59,size1,.)) as r59,
			sum(ifn(ret5=60,size1,.)*retd)/sum(ifn(ret5=60,size1,.)) as r60,
			sum(ifn(ret5=61,size1,.)*retd)/sum(ifn(ret5=61,size1,.)) as r61,
			sum(ifn(ret5=62,size1,.)*retd)/sum(ifn(ret5=62,size1,.)) as r62,
			sum(ifn(ret5=63,size1,.)*retd)/sum(ifn(ret5=63,size1,.)) as r63,
			sum(ifn(ret5=64,size1,.)*retd)/sum(ifn(ret5=64,size1,.)) as r64,
			sum(ifn(ret5=65,size1,.)*retd)/sum(ifn(ret5=65,size1,.)) as r65,
			sum(ifn(ret5=66,size1,.)*retd)/sum(ifn(ret5=66,size1,.)) as r66,
			sum(ifn(ret5=67,size1,.)*retd)/sum(ifn(ret5=67,size1,.)) as r67,
			sum(ifn(ret5=68,size1,.)*retd)/sum(ifn(ret5=68,size1,.)) as r68,
			sum(ifn(ret5=69,size1,.)*retd)/sum(ifn(ret5=69,size1,.)) as r69,
			sum(ifn(ret5=70,size1,.)*retd)/sum(ifn(ret5=70,size1,.)) as r70,
			sum(ifn(ret5=71,size1,.)*retd)/sum(ifn(ret5=71,size1,.)) as r71,
			sum(ifn(ret5=72,size1,.)*retd)/sum(ifn(ret5=72,size1,.)) as r72,
			sum(ifn(ret5=73,size1,.)*retd)/sum(ifn(ret5=73,size1,.)) as r73,
			sum(ifn(ret5=74,size1,.)*retd)/sum(ifn(ret5=74,size1,.)) as r74,
			sum(ifn(ret5=75,size1,.)*retd)/sum(ifn(ret5=75,size1,.)) as r75,
			sum(ifn(ret5=76,size1,.)*retd)/sum(ifn(ret5=76,size1,.)) as r76,
			sum(ifn(ret5=77,size1,.)*retd)/sum(ifn(ret5=77,size1,.)) as r77,
			sum(ifn(ret5=78,size1,.)*retd)/sum(ifn(ret5=78,size1,.)) as r78,
			sum(ifn(ret5=79,size1,.)*retd)/sum(ifn(ret5=79,size1,.)) as r79,
			sum(ifn(ret5=80,size1,.)*retd)/sum(ifn(ret5=80,size1,.)) as r80,
			sum(ifn(ret5=81,size1,.)*retd)/sum(ifn(ret5=81,size1,.)) as r81,
			sum(ifn(ret5=82,size1,.)*retd)/sum(ifn(ret5=82,size1,.)) as r82,
			sum(ifn(ret5=83,size1,.)*retd)/sum(ifn(ret5=83,size1,.)) as r83,
			sum(ifn(ret5=84,size1,.)*retd)/sum(ifn(ret5=84,size1,.)) as r84,
			sum(ifn(ret5=85,size1,.)*retd)/sum(ifn(ret5=85,size1,.)) as r85,
			sum(ifn(ret5=86,size1,.)*retd)/sum(ifn(ret5=86,size1,.)) as r86,
			sum(ifn(ret5=87,size1,.)*retd)/sum(ifn(ret5=87,size1,.)) as r87,
			sum(ifn(ret5=88,size1,.)*retd)/sum(ifn(ret5=88,size1,.)) as r88,
			sum(ifn(ret5=89,size1,.)*retd)/sum(ifn(ret5=89,size1,.)) as r89,
			sum(ifn(ret5=90,size1,.)*retd)/sum(ifn(ret5=90,size1,.)) as r90,
			sum(ifn(ret5=91,size1,.)*retd)/sum(ifn(ret5=91,size1,.)) as r91,
			sum(ifn(ret5=92,size1,.)*retd)/sum(ifn(ret5=92,size1,.)) as r92,
			sum(ifn(ret5=93,size1,.)*retd)/sum(ifn(ret5=93,size1,.)) as r93,
			sum(ifn(ret5=94,size1,.)*retd)/sum(ifn(ret5=94,size1,.)) as r94,
			sum(ifn(ret5=95,size1,.)*retd)/sum(ifn(ret5=95,size1,.)) as r95,
			sum(ifn(ret5=96,size1,.)*retd)/sum(ifn(ret5=96,size1,.)) as r96,
			sum(ifn(ret5=97,size1,.)*retd)/sum(ifn(ret5=97,size1,.)) as r97,
			sum(ifn(ret5=98,size1,.)*retd)/sum(ifn(ret5=98,size1,.)) as r98,
			sum(ifn(ret5=99,size1,.)*retd)/sum(ifn(ret5=99,size1,.)) as r99
		from retd_ret5
		group by date
		order by date;
quit;

proc download out=r.retd_ret5_100;
run;

endrsubmit;
